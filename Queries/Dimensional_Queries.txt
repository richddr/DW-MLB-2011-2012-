create table DIM_EQUIPOS(codigo int PRIMARY KEY, division varchar(10), nombre_equipo varchar(50),nombre_abreviado char(3), nombre_estadio varchar(75), codigo_liga int, nombre_liga varchar(30),nombre_abreviado_liga char(2));
create table DIM_JUGADORES(codigo int PRIMARY KEY, nombre varchar(20), nombre_preferido varchar(20), apellido varchar(30), jersey int, posicion char(2) CHECK(posicion in ('C','SP','RP', 'P','1B','DH','2B','3B','SS', 'IF', 'OF','LF','CF','RF')),bats char(1) CHECK(bats in ('L','R','B')), throws char(1) CHECK(throws in ('L','R','B')), height decimal(9,3)(3,2), weight_lb int, born date,birthcountry varchar(20),highschool varchar(80), college varchar(80), debut date);
create table FACT_BATEO(equipo int not null references DIM_EQUIPOS(codigo), anio int not null,posicion char(2) CHECK(posicion in('C','SP','RP', 'DH', 'MI', 'OF', 'UT', 'P', 'IF', 'CI','1B','2B','3B','SS','LF','CF','RF')),jugador int not null references DIM_JUGADORES(codigo), edad int, games_pp int, plate_appearances int, at_bats int, runs_sa int,hits_sa int,doubles_sa int,triples_sa int, hr_sa int, rbi int, stolen_bases int, caught_stealing int, walks int, strikeouts int,hits_attacks decimal(9,3), obp decimal(9,3), slg decimal(9,3), ops decimal(9,3), ops_plus int, total_bases int,grounded_dp int, hbp int, sacrifice_hits int,sacrifice_flies int, intentional_walks int);
create  table FACT_PITCHEO(equipo int not null references DIM_EQUIPOS(codigo), anio int not null, posicion char(2) CHECK(posicion in ('C','SP','RP', 'DH', 'MI', 'OF', 'UT', 'P', 'IF', 'CL','CI','1B','2B','3B','SS','LF','CF','RF')),jugador int not null REFERENCES DIM_JUGADORES(codigo), edad int, wins int, losses int, wl_p decimal(9,3), era decimal(9,3), games_played int,  games_started int, games_finished int, complete_games int, shutouts int, saves int, innings_pitched decimal(9,3), hits int, runs int,earned_runs int, home_runs int, walks int, intentional_walks int, strikeouts int,hpb int, balks int, wild_pitches int, batters_faced int, era_plus int, whip decimal(9,3), h9 decimal(9,3), hr9 decimal(9,3), bb9 decimal(9,3), so9 decimal(9,3),sobb decimal(9,3));
create table FACT_FILDEO(equipo int not null references DIM_EQUIPOS(codigo), anio int not null,jugador int not null references DIM_JUGADORES(codigo), edad int, games int, games_started int,complete_games int, innings_played decimal(9,3), defensive_chances int, putouts int, assists int, errors int, double_plays int, fielding_percentage decimal(9,3), rtot int, rot_year int, r_drs int,r_drs_year int, range_factor9 decimal(9,3), rfg decimal(9,3), passed_balls int, wild_pitches int, stolen_bases int, caugh_stealing int, caught_stealingp varchar(5),lgcps varchar(5), pickoffs int,pos_summary varchar(30));